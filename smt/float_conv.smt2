(define-sort Float80 () (_ FloatingPoint 15 65))

(declare-const a Float64)
(declare-const b Float80)
(assert (= ((_ to_fp 11 53) RNE b) a))

(declare-const a-bv (_ BitVec 64))
(assert (= ((_ to_fp 11 53) a-bv) a))
(declare-const b-bv (_ BitVec 80))
(assert (= ((_ to_fp 15 65) b-bv) b))

;(push)
;(assert (fp.isNormal a))
;(declare-const c Float80)
;(assert (= c ((_ to_fp 15 65) (concat 
;  ((_ extract 63 63) a-bv)
;  ((_ sign_extend 4) ((_ extract 62 52) a-bv))
;  ((_ extract 51 0) a-bv)
;  #b000000000000))))
;(assert (not (= b c)))
;(check-sat)
;(get-model)
;(pop)

(push)
(declare-const c (_ BitVec 16))
(push)
(declare-const real Bool) (assert (= real (bvult (bvadd c #xC3FF) (bvadd c #xBC01))))
(declare-const fake Bool) (assert (= fake (and (bvsge (bvsub c #x3FFF) ((_ int2bv 16) -1022)) (bvsle (bvsub c #x3FFF) #x03FF))))
(assert (not (= real fake)))
(check-sat)
(pop)

(push)
(assert (bvult c (bvsub #x3FFF #x03FF)))
(declare-const d Bool)
(assert (= d (bvult c ((_ int2bv 16) 15297))))
(assert (not (= d (bvugt (bvsub (bvsub #x3FFF #x03FF) c) #x003F))))
(check-sat)
(pop)

(push)
(assert (bvuge c ((_ int2bv 16) 15297)))
(assert (bvult c ((_ int2bv 16) 15361)))
(assert (not (= (bvsub (bvsub #x3FFF #x03FF) c) (bvand (bvsub #x0000 c) #x003F))))
(check-sat)
(pop)
(pop)

(push)
(declare-const c (_ BitVec 64))
(define-const d (_ BitVec 12) ((_ extract 63 52) c))
(assert (= ((_ extract 63 63) c) #b0))
(push)
(declare-const e (_ BitVec 64))
(assert (= e (bvadd c #xFFF0000000000000)))
(assert (not (= (bvult e #x7FE0000000000000) (and (not (= d #x000)) (not (= d #x7FF))))))
(check-sat)
(pop)
(pop)
